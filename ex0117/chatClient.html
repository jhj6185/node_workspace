<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>
    <h3>채팅 클라이언트</h3>
    <br>
    <div>
        <input type="text" id="hostInput" value="localhost"/>
        <input type="text" id="portInput" value="3000"/>
        <input type="button" id="connectButton" value="연결하기"/>
    </div><br>
    <div>
        <span>보내는 사람 아이디 : </span>
        <input type="text" id="senderInput" value="test01">
    </div>
    <div>
        <span>받는 사람 아이디 : </span>
        <input type="text" id="recepientInput" value="ALL">
    </div>
    <div>
        <span>메시지 데이터 : </span>
        <input type="text" id="dataInput" value="안녕!">
    </div><br>
    <hr/>
    <p>결과 : </p>
    <div id="result"></div>
</body>
<script src="/socket.io/socket.io.js"></script>
<!-- 이거는 socketio npm install 해서 깐 것을 불러내는거라 무조건 이 경로임 -->
<script>
    var host;
    var port;
    var socket;
    $(function(){
        //문서 로딩 후 실행됨
        $("#connectButton").bind('click', function(event){
            println('connectButton이 클릭됨');
            host = $('#hostInput').val();
            port = $('#portInput').val();
            connectToServer();
        });
    });
    function connectToServer(){
        //서버에 연결하는 함수 정의
        var options= {'forceNew': true};
        var url = 'http://'+host+':'+port;
        socket = io.connect(url,options);
        socket.on('connect', function(){ //연결됐을때
            println('웹소켓 서버에 연결됨 : '+url);
        });
        socket.on('disconnect',function(){ //종료됐을 때
            println('웹소켓 연결이 종료됨');
        });
    }
    function println(data){ //#result에 계속 쓸 수 있도록 println함수를 따로뺌
        console.log(data);
        $('#result').append('<p>'+data+'</p>');
    }
</script>
</html>
<!-- 보내는것 emit 받는것 on -->